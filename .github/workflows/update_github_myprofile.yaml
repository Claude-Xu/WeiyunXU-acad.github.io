name: Update github myprofile

on:
  workflow_dispatch:
  schedule:
    - cron: "0 9 * * *"   # 每天 09:00 UTC（可改）
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Install Reqs
      run: |
        sudo apt-get update
        sudo apt-get install -y python3-setuptools
    - name: Run updater
      run: |
        cd ./github_myprofile_updater
        python3 update.py
    - name: Push to target repo
      run: |
        git config --global user.name "${GITHUB_ACTOR}"
        git config --global user.email "weiyunxu28@gmail.com"

        # 1) clone 目标仓库（换成你自己的）
        TARGET_REPO="https://${GITHUB_ACTOR}:${{ secrets.GHRS_GITHUB_API_TOKEN }}@github.com/Claude-Xu/WeiyunXU-acad.github.io.git"
        git clone "$TARGET_REPO" target_repo

        # 2) 复制你要更新的内容（按你脚本产物调整路径）
        cp -f ./github_myprofile_updater/README.md target_repo/README.md
        rm -rf target_repo/images
        cp -r ./github_myprofile_updater/images target_repo/images

        # 3) commit & push（不建议 --force，除非你非常确定）
        cd target_repo
        git add README.md images
        git commit -m "update my description automatically" || echo "No changes"
        git push origin main
